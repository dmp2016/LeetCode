from typing import List
from collections import Counter, defaultdict


class Solution:

    def threeSumMulti1(self, arr: List[int], target: int) -> int:
        cnt = 0
        store_r = [(ind1, Counter(
            [arr[ind1] + arr[ind2] for ind2 in range(ind1 + 1, len(arr))]))
            for ind1 in range(1, len(arr) - 1)]
        store_l = Counter([arr[ind] for ind in range(len(arr) - 2)])
        k = len(arr) - 1
        i, j = k - 2, k - 1
        while j >= 1:
            # for k in range(j + 1, len(arr)):
            #     store_r[arr[j] + arr[k]] += 1
            store_r = Counter([arr[j] + arr[k] for k in range(j + 1, len(arr))])
            for a in range(0, 101):
                cnt += store_l[a] * store_r[target - a]
                cnt %= 1000000007
            j -= 1
            store_l[arr[i]] -= 1
            i -= 1
        return cnt

    def threeSumMulti2(self, arr: List[int], target: int) -> int:
        store = [(ind1, Counter(
            [arr[ind1] + arr[ind2] for ind2 in range(ind1 + 1, len(arr))]))
            for ind1 in range(1, len(arr) - 1)]
        store = dict(store)
        store1 = {len(arr) - 2: store[len(arr) - 2]}
        for ind in range(len(arr) - 3, 0, -1):
            store1[ind] = store[ind]
            for a in range(0, 201):
                store1[ind][a] += store1[ind + 1][a]

        cnt = 0
        for ind in range(len(arr) - 2):
            cnt += store1[ind + 1][target - arr[ind]]
            cnt %= 1000000007
        return cnt

    def threeSumMulti(self, arr: List[int], target: int) -> int:
        cnt = 0
        store = Counter([arr[i] for i in range(len(arr))])
        for a in range(101):
            for b in range(101):
                c = target - a - b
                if c >= 0:
                    m1 = store[a]
                    m2 = store[b]
                    if a == b:
                        m2 -= 1
                    m3 = store[c]
                    if a == c:
                        m3 -= 1
                    if b == c:
                        m3 -= 1
                    m2 = max(0, m2)
                    m3 = max(0, m3)
                    cnt += m1 * m2 * m3
        return (cnt // 6) % 1000000007

test = Solution()
print(test.threeSumMulti(arr=[1, 2, 3, 1], target=6))
print(test.threeSumMulti(arr=[1, 1, 2, 2, 3, 3, 4, 4, 5, 5], target=8))
print(test.threeSumMulti(arr=[1, 1, 2, 2, 2, 2], target=5))
print(test.threeSumMulti(arr=[49,63,22,51,18,53,83,43,93,45,38,93,76,46,61,65,27,51,16,59,74,57,67,50,61,19,68,94,18,47,64,31,70,48,68,75,93,81,86,94,77,27,29,22,98,54,15,60,61,87,77,15,48,15,33,40,34,40,0,31,61,6,7,0,29,30,85,61,66,64,64,84,80,17,37,5,54,79,88,47,32,3,59,91,41,58,9,62,3,0,79,35,79,66,6,23,42,53,97,89,86,44,98,52,31,67,73,90,30,2,57,47,97,15,83,86,15,14,47,5,58,10,34,58,8,41,76,56,91,84,78,83,38,41,0,91,68,26,64,76,97,91,6,82,79,51,37,57,89,2,9,72,51,13,14,87,68,23,49,35,71,97,19,93,84,58,100,24,1,79,75,75,16,32,95,82,39,15,85,37,26,68,89,74,100,29,30,92,13,80,7,26,16,43,30,96,51,41,34,26,44,94,87,36,100,31,32,19,32,31,19,85,58,36,46,33,42,84,20,97,56,4,94,25,70,0,93,94,38,79,32,21,24,16,64,39,0,16,9,74,45,9,35,70,80,37,89,85,1,39,20,91,69,31,22,56,38,38,69,96,88,98,76,66,54,6,99,63,31,80,39,14,41,10,4,83,33,100,86,43,59,20,73,34,78,66,70,50,26,66,47,0,49,38,11,12,90,10,54,77,46,29,33,2,4,49,75,42,83,85,51,4,24,86,0,21,39,6,69,52,46,67,37,95,15,52,5,83,2,58,58,20,31,18,44,4,65,76,9,68,31,57,30,91,56,65,54,40,64,19,48,43,14,29,81,44,34,23,5,13,95,0,93,93,9,31,46,23,43,66,71,84,41,59,71,56,76,81,64,55,49,58,50,51,91,5,20,29,58,88,85,14,36,6,43,53,88,1,35,96,58,66,81,54,34,8,64,9,62,21,84,77,2,69,31,43,98,100,38,71,59,55,23,78,45,2,87,61,69,85,57,85,43,44,90,38,24,65,81,30,65,85,31,38,49,49,42,32,84,57,80,46,0,91,8,22,84,14,67,15,60,71,33,4,80,2,45,73,54,7,51,70,53,7,6,39,88,41,95,76,40,35,90,23,96,12,18,9,33,6,58,93,10,94,90,51,80,75,92,93,40,45,29,6,43,86,82,97,45,80,31,19,73,50,98,73,62,99,45,39,64,21,28,79,6,33,29,83,0,45,100,12,39,38,44,90,74,55,63,66,73,70,77,52,71,33,34,18,97,66,88,74,25,32,61,28,34,34,58,44,18,20,38,29,97,73,42,25,60,11,22,93,54,85,21,2,90,16,13,92,9,20,18,88,73,92,27,25,74,39,12,10,82,99,56,68,37,12,96,85,44,51,47,66,5,69,53,39,60,92,65,78,19,1,51,49,37,36,6,86,90,56,95,3,73,59,95,77,34,9,70,20,19,38,51,23,8,43,95,81,77,62,38,31,98,53,69,0,4,23,71,31,85,11,55,40,22,2,12,41,62,47,78,13,36,59,59,99,91,35,88,56,81,11,100,17,50,91,35,37,75,95,58,99,53,99,54,40,30,75,66,58,16,98,4,15,70,19,23,78,29,10,56,80,46,11,47,43,57,0,20,75,9,7,71,76,55,45,10,49,70,39,62,77,56,17,6,60,31,7,17,61,55,21,46,12,77,41,33,16,69,51,47,30,62,36,88,29,94,77,39,97,45,48,8,58,12,44,59,53,64,89,22,62,7,16,91,75,17,37,49,78,68,70,10,32,41,2,55,46,87,62,87,96,44,57,96,33,34,19,38,95,40,74,12,67,40,26,96,7,84,49,32,49,33,40,31,16,43,10,61,0,93,75,42,4,31,10,40,93,24,14,8,5,24,15,49,31,41,71,10,97,0,19,30,10,2,12,60,23,67,57,62,66,15,72,51,56,82,12,27,64,58,13,75,85,61,3,90,23,35,21,100,94,45,70,31,22,46,50,75,61,70,98,0,76,54,26,0,46,9,7,57,6,67,30,15,45,16,98,39,60,59,13,25,4,74,47,1,16,86,8,50,95,34,35,24,60,58,67,91,2,100,19,70,77,60,28,89,33,38,48,28,6,97,15,2,26,89,89,26,89,44,40,16,27,98,5,28,29,58,24,84,20,34,79,54,33,54,80,83,82,47,43,14,48,51,61,35,96,83,26,47,42,94,63,24,9,42,69,49,4,20,32,81,84,0,92,73,80,87,4,60,98,53,79,84,86,62,4,46,96,35,39,13,40,60,4,11,43] * 3, target=105))
